---
import mapboxgl from "mapbox-gl";
---

<div id="map" class="w-full h-[600px] rounded-xl shadow-lg"></div>

<style>
  #map {
    border: 3px solid #10b981; /* verde cultural */
  }
</style>

<script is:inline>
  mapboxgl.accessToken = "pk.eyJ1IjoiMjI2dzA0OTYiLCJhIjoiY21mc2NoZmxnMGpzbjJucTN2NXZ0MHEwZiJ9.uvpAmMbzFqGOUKHlWxogdg"; // ðŸ”‘ pon aquÃ­ tu token de Mapbox

  const map = new mapboxgl.Map({
    container: "map",
    style: "mapbox://styles/mapbox/light-v11",
    center: [-102.5528, 23.6345], // Centro de MÃ©xico
    zoom: 4,
    pitch: 45, // Vista 3D
    bearing: -17.6,
    antialias: true,
  });

  map.on("load", () => {
    map.addSource("mexico", {
      type: "vector",
      url: "mapbox://mapbox.country-boundaries-v1",
    });

    map.addLayer({
      id: "states-fill",
      type: "fill",
      source: "mexico",
      "source-layer": "country_boundaries",
      paint: {
        "fill-color": "#10b981",
        "fill-opacity": 0.4,
      },
      filter: ["==", ["get", "iso_3166_1"], "MX"],
    });

    map.addLayer({
      id: "states-outline",
      type: "line",
      source: "mexico",
      "source-layer": "country_boundaries",
      paint: {
        "line-color": "#064e3b",
        "line-width": 1.5,
      },
      filter: ["==", ["get", "iso_3166_1"], "MX"],
    });

    // Evento al hacer clic en un estado
    map.on("click", "states-fill", (e) => {
      const estado = e.features[0].properties.name_es;
      window.location.href = `/estado/${estado.toLowerCase()}`;
    });

    // Cambiar cursor
    map.on("mouseenter", "states-fill", () => {
      map.getCanvas().style.cursor = "pointer";
    });
    map.on("mouseleave", "states-fill", () => {
      map.getCanvas().style.cursor = "";
    });
  });
</script>
